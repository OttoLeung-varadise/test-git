[SERVICE]
    Flush         5
    Log_Level     info
    Parsers_File  parsers.conf

# 输入：采集 Gin 容器的控制台日志
[INPUT]
    Name          tail
    Tag           docker.*
    Path          /var/lib/docker/containers/*/*.log
    Refresh_Interval 10    
    DB            /var/log/fluent-bit-docker.db
    Mem_Buf_Limit 5MB     

[FILTER]
    Name          grep
    Match         docker.*
    Regex         $docker.container.name ^gin-app$

[FILTER]
    Name          parser
    Match         docker.*
    Key_Name      log  
    Parser        json 
    Reserve_Data  On 

# 输出：将解析后的日志写入 PostgreSQL
[OUTPUT]
    Name          pgsql
    Match         gin.log   
    Host          postgres 
    Port          5432      
    User          postgres  
    Password      postgres  
    Database      postgres      
    Table         gin_request_logs  
    # 字段映射：Fluent Bit 解析后的字段 → PostgreSQL 表字段（顺序需一致）
    Columns       timestamp,method,path,status,latency,client_ip,user_agent
    Timestamp_Key timestamp  